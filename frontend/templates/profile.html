<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Log in</title>
    <!-- plugins:css -->
    <link rel="stylesheet"
        href="{{ url_for('static', filename='vendors/iconfonts/mdi/css/materialdesignicons.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='vendors/css/vendor.addons.css') }}" />
    <!-- endinject -->
    <!-- vendor css for this page -->
    <!-- End vendor css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/shared/style.css') }}" />
    <!-- endinject -->
    <!-- Layout style -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/demo_1/style.css') }}">
    <!-- Layout style -->
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}" />

</head>

<body>
    <div class="authentication-theme auth-style_1">
        <!-- <div class="row">
            <div class="col-12 logo-section">
                <a href="/index.html" class="logo">
                    <p class="logo" style="color:#696ffb">Byte_me</p>
                    <p class="logo-mini" style="color:#696ffb">B</p>
                </a>
            </div>
        </div> -->
        <div class="row">
            <div class="col-lg-5 col-md-7 col-sm-9 col-11 mx-auto">
                <div class="grid">
                    <div class="grid-body">
                        <div class="row">
                            <div class="col-lg-7 col-md-8 col-sm-9 col-12 mx-auto form-wrapper">
                                <form action="#">
                                    <div class="form-group input-rounded">
                                        <label>Username:</label>
                                        <input type="text" class="form-control" id="profile-username" disabled></input>
                                    </div>
                                    <div class="form-group input-rounded">
                                        <label>Full Name:</label>
                                        <input type="text" class="form-control" id="profile-fullname" disabled></input>
                                    </div>
                                    <div class="form-group input-rounded">
                                        <label>Password:</label>
                                        <input type="password" class="form-control" id="profile-password"
                                            placeholder="Leave blank for no change" />
                                    </div>
                                    <button type="submit" id="save" class="btn btn-primary btn-block"> Save </button>
                                    <button type="submit" id="cancel" class="btn btn-primary btn-block"> Cancel
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--page body ends -->
    <!-- SCRIPT LOADING START FORM HERE /////////////-->
    <!-- plugins:js -->
    <script src="{{ url_for('static', filename='vendors/js/core.js') }}"></script>
    <script src="{{ url_for('static', filename='vendors/js/vendor.addons.js') }}"></script>
    <script>
        $(document).ready(function () {
            document.getElementById("profile-username").value = sessionStorage.getItem("username");
            document.getElementById("profile-fullname").value = sessionStorage.getItem("name");
        });

        function changePassword() {
            const password = document.getElementById("save");
            password.addEventListener("click", function (event) {
                event.preventDefault();
                const newPass = document.getElementById("profile-password").value.trim();
                if (!newPass) {
                    window.location.href = "/dashboard.html";
                } else {
                    let formData = new FormData();
                    formData.append("password", password.value);
                    fetch("http://127.0.0.1:5000/changepassword", {
                            method: "POST",
                            body: formData
                        }).then(resp => resp.json())
                        .then(response => {
                            window.location.href = "/dashboard.html";
                        });
                }
            });
        }


        function cancelButton() {

            document.getElementById("cancel").addEventListener("click", function (event) {

                event.preventDefault();
                window.location.href = "/dashboard.html";
            });
        }

        changePassword();
        cancelButton();
    </script>
    <!-- endinject -->
    <!-- Vendor Js For This Page Ends-->
    <!-- Vendor Js For This Page Ends-->
    <!-- build:js -->
    <!-- <script src="{{ url_for('static', filename='js/profile.js') }}"></script> -->
    <script src="{{ url_for('static', filename='js/template.js') }}"></script>

    <!-- endbuild -->
</body>

</html>